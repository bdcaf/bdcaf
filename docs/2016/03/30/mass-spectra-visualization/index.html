<!DOCTYPE html>
<html lang="en-uk">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.32.4" />
  <meta name="author" content="Clemens Ager">
  <meta name="description" content="Number Cruncher // PhD Candidate // Physicist">

  
  
  
  
    
    
    <link rel="stylesheet" href="https://bdcaf.gitlab.io/bdcaf/css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.0/css/academicons.min.css" integrity="sha512-GGGNUPDhnG8LEAEDsjqYIQns+Gu8RBs4j5XGlxl7UfRaZBhCCm5jenJkeJL8uPuOXGqgl8/H1gjlWQDRjd3cUQ==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather%7CRoboto+Mono">
  <link rel="stylesheet" href="https://bdcaf.gitlab.io/bdcaf/css/hugo-academic.css">
  
  <link rel="stylesheet" href="https://bdcaf.gitlab.io/bdcaf/css/cle.css">
  
  <link rel="stylesheet" href="https://bdcaf.gitlab.io/bdcaf/css/flags.css">
  

  

  <link rel="alternate" href="https://bdcaf.gitlab.io/bdcaf/index.xml" type="application/rss+xml" title="Clemens Ager">
  <link rel="feed" href="https://bdcaf.gitlab.io/bdcaf/index.xml" type="application/rss+xml" title="Clemens Ager">

  <link rel="icon" type="image/png" href="https://bdcaf.gitlab.io/bdcaf/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="https://bdcaf.gitlab.io/bdcaf/img/apple-touch-icon.png">

  <link rel="canonical" href="https://bdcaf.gitlab.io/bdcaf/2016/03/30/mass-spectra-visualization/">

  

  <title>Mass spectra visualization | Clemens Ager</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://bdcaf.gitlab.io/bdcaf/">Clemens Ager</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="https://bdcaf.gitlab.io/bdcaf/#about">
            
            <span>About</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="https://bdcaf.gitlab.io/bdcaf/#posts">
            
            <span>Posts</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="https://bdcaf.gitlab.io/bdcaf/#publications_selected">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="https://bdcaf.gitlab.io/bdcaf/#projects">
            
            <span>Projects</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="https://bdcaf.gitlab.io/bdcaf/#contact">
            
            <span>Contact</span>
          </a>
        </li>

        
        

        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">Mass spectra visualization</h1>
    

<div class="article-metadata">

  <span class="article-date">
    <time datetime="2016-03-30 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      2016-03-30
    </time>
  </span>

  

  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="https://bdcaf.gitlab.io/bdcaf/tags/sci">sci</a
    >, 
    
    <a href="https://bdcaf.gitlab.io/bdcaf/tags/visualization">visualization</a
    >
    
  </span>
  
  

  
  

  

</div>

    <div class="article-style" itemprop="articleBody">
      <p>I saw some <a href="http://datadrivensecurity.info/blog/posts/2015/Jan/mapping-ipv4-address-in-hilbert-space/" target="_blank">nice visualiztion for IP
adresses</a>
which made use of the hilbert curve for mapping sequatial data into an
area. This has the nice benefit of assuring numbers that are close to
each other stay close in two dimensions as well.  Unfortunately the
opposite does not hold.  Conveniently a function to produce a hilbert
curve is provided via
<a href="https://bioconductor.org/packages/release/bioc/html/HilbertVis.html" target="_blank">HilbertVis</a>
on bioconductor.</p>

<p></p>

<h3 id="ptr-ms-spectra">PTR-MS spectra</h3>

<p>I have been playing with PTR-MS data for some while.  It&rsquo;s always hard to
visualize this datasets. There are some nice patterns showing up - isotopic and
due to hydratization.</p>

<h3 id="data">data</h3>

<p>I will not show out reading out the data - it was collected using a Ionicon PTR-TOF MS
which requires tedious preprocessing - most of which I can finally do in R but
the code is poorly documented so far.  The measurment is actually from a proband
who took a sip of ethanol a few minutes before measurement.</p>

<p>Just a glimpse of it looks like this:</p>

<table>
<thead>
<tr>
<th>mass</th>
<th>counts</th>
</tr>
</thead>

<tbody>
<tr>
<td>21</td>
<td>142720</td>
</tr>

<tr>
<td>22</td>
<td>18708</td>
</tr>

<tr>
<td>23</td>
<td>8148</td>
</tr>

<tr>
<td>24</td>
<td>7137</td>
</tr>

<tr>
<td>25</td>
<td>6711</td>
</tr>

<tr>
<td>26</td>
<td>6468</td>
</tr>
</tbody>
</table>

<h2 id="experiments">Experiments</h2>

<p>Since over m/z 100 there is only sparse signal I created the relevant Hilbert
curve doing</p>

<h3 id="curves">Curves</h3>

<p>The first plot uses scales the area of the dots at the masses to the observed counts.</p>

<p><img src="https://bdcaf.gitlab.io/bdcaf/~c1891011/photo/2016-01-hilbertPTR_fig/2016-01-hilbertPTR_firsttry-1.png" alt="plot of chunk first try" /></p>

<p>This plot shows a little structure - the main blocks are of 16 numbers.</p>

<ul>
<li>The numbers 1 to 16 are basically zero as there are no protonated ions at such masses.<br /></li>
<li>The next block contains the major precursors - the hydronium ion
\(H_3O^+\) with its isotopes at m/z 19 to 21, \(NO^+\) at 30 and
\(O_2^+\) at 32. A little visible is ammonia at m/z 18.</li>
<li>The block from 33 to 48 contains the Zundel ion (\(H_2O \cdot
H_3O^+\) ) as well as ethanol at 47 (with some isotops at 48) and its
metabolite acetaldehyde at 45.</li>
<li>Following block contains the important compound acetone at 59 and
not visible the next metabolite of ethanol acetic acid at 61.</li>
<li>Next block contains isoprene at 69 as well as hydrated ethanol ion at 65.</li>
<li>The following blocks show no visible ions although at aromatics like toluene (m/z 93) should show up there.</li>
</ul>

<p>Unfortunately when observed on the PTR-TOF it can be seen that the signal is
saturated at m/z 19, 37 and 47. So lets scale down the max signal.<br />
The concentration of the observed compounds is in the ppm&rsquo;s.
<img src="https://bdcaf.gitlab.io/bdcaf/~c1891011/photo/2016-01-hilbertPTR_fig/2016-01-hilbertPTR_scaledin-1.png" alt="plot of chunk scaled in" /></p>

<p>Finally we see a little more.  But still only compounds that occur in<br />
concentrations of several ppbs.</p>

<p>Lets try to use logarithmic scale instead.</p>

<p><img src="https://bdcaf.gitlab.io/bdcaf/~c1891011/photo/2016-01-hilbertPTR_fig/2016-01-hilbertPTR_logscale-1.png" alt="plot of chunk log scale" /></p>

<p>Now the plot shows many more compounds.  All the main ions are tailed by some ions of their isotopes. Though it is still hard to see where some traces occur. I experimentd with some zooming but overall there was little benefit to it.  My next try will be to see if I can create an animated version of this to follow a volunteers breath pattern.</p>

<p>The code for this page was written in <code>R</code>.  I will keep investigating and probably put a link to the git repo online once it reaches a more mature state.</p>
    </div>
  </div>

</article>

<div class="container">
  <nav>
  <ul class="pager">
    
    <li class="previous"><a href="https://bdcaf.gitlab.io/bdcaf/2015/11/24/zero-axis-video/"><span
      aria-hidden="true">&larr;</span> Zero Axis Video</a></li>
    

    
    <li class="next"><a href="https://bdcaf.gitlab.io/bdcaf/2016/07/17/r.e.-kalman-verstorben/">R.E. Kalman verstorben <span
      aria-hidden="true">&rarr;</span></a></li>
    
  </ul>
</nav>

</div>

<div class="article-container">
  

</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      Clemens Ager, Brixlegg &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha512-jGsMH83oKe9asCpkOVkBnUrDDTp8wl+adkB2D+//JtlxO4SrLoJdhbOysIFQJloQFD+C4Fl1rMsQZF76JjV0eQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js" integrity="sha512-iHzEu7GbSc705hE2skyH6/AlTpOfBmkx7nUqTLGzPYR+C1tRaItbRlJ7hT/D3YQ9SV0fqLKzp4XY9wKulTBGTw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/TweenMax.min.js" integrity="sha512-Z5heTz36xTemt1TbtbfXtTq5lMfYnOkXM2/eWcTTiLU01+Sw4ku1i7vScDc8fWhrP2abz9GQzgKH5NGBLoYlAw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/plugins/ScrollToPlugin.min.js" integrity="sha512-CDeU7pRtkPX6XJtF/gcFWlEwyaX7mcAp5sO3VIu/ylsdR74wEw4wmBpD5yYTrmMAiAboi9thyBUr1vXRPA7t0Q==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    <script src="https://bdcaf.gitlab.io/bdcaf/js/hugo-academic.js"></script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

