{{ $ := .root }}
{{ $page := .page }}

<!-- Projects widget -->
<div class="row">
  <div class=" main-leftcol section-heading">
    <h1>{{ with $page.Title }}{{ . | markdownify }}{{ end }}</h1>
    {{ with $page.Params.subtitle }}<p>{{ . | markdownify }}</p>{{ end }}
  </div>
  <div class=" main-rightcol">
    {{ with $page.Content }}<p>{{ . | markdownify }}</p>{{ end }}

    {{ if eq $page.Params.view 0 }}

    <div id="container-projects" >
      <ul class="fa-ul" style="position: relative">

        {{ range where $.Data.Pages "Type" "project" }}
        <li class="project-item {{ delimit .Params.tags " " }}">
          <span class="project-title">
          {{ if .Content }}
          <a href="{{ .Permalink }}">
          {{ else }}
            {{ with .Params.external_link }}<a href="{{ . }}">{{ end }}
          {{ end }}
          <i class="fa-li fa fa-files-o pub-icon" aria-hidden="true"></i>
          {{ .Title }}
          {{ if .Content }}</a>{{ else }}{{ with .Params.external_link }}</a>{{ end }}{{ end }}
          </span>
          {{ with .Params.summary }}<p class="project-summary">{{ . | markdownify }}</p>{{ end }}
        </li>
        {{ end }}

      </ul>
    </div>

    {{ else }}

    <div id="container-projects" class="row ">

      {{ range $project := where $.Data.Pages "Type" "project" }}
      {{ $.Scratch.Set "project_url" $project.Permalink }}
      {{ if $project.Params.external_link }}
      {{   $.Scratch.Set "project_url" $project.Params.external_link }}
      {{ end }}
      <div class=" col-sm-6 main-leftcol col-lg-6 project-item {{ delimit .Params.tags " " }}">
        <div class="card">
          {{ with $project.Params.image_preview }}
          <a href="{{ $.Scratch.Get "project_url" }}" title="" class="card-image hover-overlay">
            <img src="{{ "/img/" | relURL }}{{ . }}" alt="" class="img-responsive">
          </a>
          {{ end }}
          <div class="card-text">
            <h4><a href="{{ $.Scratch.Get "project_url" }}">{{ .Title }}</a></h4>
            <div class="card-desription">
              {{ with $project.Params.summary }}<p>{{ . | markdownify }}</p>{{ end }}
            </div>
          </div>
        </div>
      </div>
      {{ end }}

    </div>

    {{ end }}

  </div>
</div>
