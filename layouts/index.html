{{- define "main" -}}

{{/* v4.5: Address changed from string to map. */}}
{{ if isset site.Params "address" }}
{{ if eq (reflect.IsMap site.Params.address) false }}
  {{ errorf "Please upgrade the `address` field in `config/_default/params.toml`. Refer to all of the Breaking Changes in v4.5 at https://sourcethemes.com/academic/updates/v4.5.0/" }}
{{ end }}
{{ end }}
{{/* Generate homepage. */}}
{{ partial "widget_page.html" . }}

<div class="widget-container">
  {{- range $index, $page := where .Data.Pages "Type" "home" -}}
    {{- $params := dict "root" $ "page" $page -}}
    {{- $widget := printf "widgets/%s.html" ( or $page.Params.widget "custom" ) -}}
    {{- partial $widget $params -}}
  {{- end -}}
</div>

{{- end -}}
